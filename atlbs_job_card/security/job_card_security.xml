<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data noupdate="0">

<!---->



    <record id="job_card_company_rule" model="ir.rule">
    <field name="name">Job Card: Company Filter</field>
    <field name="model_id" ref="atlbs_job_card.model_job_card_management"/> <!-- e.g., "your_module.model_open_order_report" -->
    <field name="domain_force">[('company_id', 'in', company_ids)]</field>
    <field name="groups" eval="[(4, ref('base.group_user'))]"/> <!-- or your custom group -->
    <field name="perm_read" eval="True"/>
    <field name="perm_write" eval="True"/>
    <field name="perm_create" eval="True"/>
    <field name="perm_unlink" eval="False"/>
</record>









<!-- Admin group to allow viewing ALL job cards -->
    <record id="group_job_card_pl_admin" model="res.groups">
        <field name="name">Job Card P&amp;L Admin</field>
        <field name="implied_ids" eval="[(4, ref('base.group_user'))]"/>

    </record>

    <!-- Rule: Internal users (service advisors) see ONLY their own job cards -->
    <record id="job_card_rule_service_advisor" model="ir.rule">
        <field name="name">Job Card: Service Advisor - own records</field>
        <field name="model_id" ref="model_job_card_management"/>
        <field name="global" eval="False"/>
        <!-- applies to regular internal users -->
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
        <field name="domain_force">[('service_advisor_id','=',user.id)]</field>
    </record>

    <!-- Rule: Admin group sees ALL job cards -->
    <record id="job_card_rule_admin" model="ir.rule">
        <field name="name">Job Card: Admin - see all</field>
        <field name="model_id" ref="model_job_card_management"/>
        <field name="global" eval="False"/>
        <field name="groups" eval="[(4, ref('atlbs_job_card.group_job_card_pl_admin'))]"/>
        <!-- domain_force true = all records -->
        <field name="domain_force">[(1,'=',1)]</field>
    </record>



<!--    new rule created on dec 08-->
    <record id="job_card_cost_analysis_rule_default_company" model="ir.rule">
        <field name="name">Job Card Cost Analysis - Default Company Only</field>
        <field name="model_id" ref="model_job_card_cost_analysis_report"/>
        <field name="domain_force">[
            '|',
            ('job_card_id.company_id', '=', user.company_id.id),
            ('id', '=', False)
            ]
        </field>
        <field name="groups" eval="[(4, ref('base.group_user'))]"/>
    </record>




</data>

</odoo>
